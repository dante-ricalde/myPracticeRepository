<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
	xmlns:int="http://www.springframework.org/schema/integration" xmlns:int-jdbc="http://www.springframework.org/schema/integration/jdbc" xmlns:int-stream="http://www.springframework.org/schema/integration/stream"
	xmlns:int-jmx="http://www.springframework.org/schema/integration/jmx" xmlns:int-file="http://www.springframework.org/schema/integration/file" xmlns:jdbc="http://www.springframework.org/schema/jdbc"
	xmlns:task="http://www.springframework.org/schema/task" xmlns:p="http://www.springframework.org/schema/p" xmlns:util="http://www.springframework.org/schema/util" xmlns:tx="http://www.springframework.org/schema/tx"
	xmlns:int-script="http://www.springframework.org/schema/integration/scripting" xmlns:int-groovy="http://www.springframework.org/schema/integration/groovy" xmlns:int-http="http://www.springframework.org/schema/integration/http"
	xmlns:int-ftp="http://www.springframework.org/schema/integration/ftp" xmlns:int-amqp="http://www.springframework.org/schema/integration/amqp" xmlns:rabbit="http://www.springframework.org/schema/rabbit"
	xmlns:int-event="http://www.springframework.org/schema/integration/event" xmlns:int-feed="http://www.springframework.org/schema/integration/feed" xmlns:gfe="http://www.springframework.org/schema/gemfire"
	xmlns:int-gfe="http://www.springframework.org/schema/integration/gemfire" xmlns:gfe-data="http://www.springframework.org/schema/data/gemfire" xmlns:int-ip="http://www.springframework.org/schema/integration/ip"
	xsi:schemaLocation="http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.2.xsd
		http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-3.2.xsd
		http://www.springframework.org/schema/integration/groovy http://www.springframework.org/schema/integration/groovy/spring-integration-groovy-2.2.xsd
		http://www.springframework.org/schema/integration/jdbc http://www.springframework.org/schema/integration/jdbc/spring-integration-jdbc-2.2.xsd
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/integration/scripting http://www.springframework.org/schema/integration/scripting/spring-integration-scripting-2.1.xsd
		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.2.xsd
		http://www.springframework.org/schema/integration/http http://www.springframework.org/schema/integration/http/spring-integration-http-2.2.xsd
		http://www.springframework.org/schema/integration/ftp http://www.springframework.org/schema/integration/ftp/spring-integration-ftp-2.2.xsd
		http://www.springframework.org/schema/integration http://www.springframework.org/schema/integration/spring-integration-2.2.xsd
		http://www.springframework.org/schema/integration/file http://www.springframework.org/schema/integration/file/spring-integration-file-2.2.xsd
		http://www.springframework.org/schema/integration/jmx http://www.springframework.org/schema/integration/jmx/spring-integration-jmx-2.2.xsd
		http://www.springframework.org/schema/integration/stream http://www.springframework.org/schema/integration/stream/spring-integration-stream-2.2.xsd
		http://www.springframework.org/schema/integration/amqp http://www.springframework.org/schema/integration/amqp/spring-integration-amqp-2.2.xsd
		http://www.springframework.org/schema/integration/event http://www.springframework.org/schema/integration/event/spring-integration-event-2.2.xsd
		http://www.springframework.org/schema/rabbit http://www.springframework.org/schema/rabbit/spring-rabbit-1.1.xsd
		http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.2.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd
		http://www.springframework.org/schema/integration/feed http://www.springframework.org/schema/integration/feed/spring-integration-feed-2.2.xsd
		http://www.springframework.org/schema/gemfire http://www.springframework.org/schema/gemfire/spring-gemfire.xsd
		http://www.springframework.org/schema/integration/gemfire http://www.springframework.org/schema/integration/gemfire/spring-integration-gemfire-2.2.xsd
		http://www.springframework.org/schema/data/gemfire http://www.springframework.org/schema/data/gemfire/spring-data-gemfire.xsd
		http://www.springframework.org/schema/integration/ip http://www.springframework.org/schema/integration/ip/spring-integration-ip-2.2.xsd">

	<!-- In this case I am testing a simple <int-ip:tcp-inbound-gateway; the connection factory is configured with the default (de)serializer (ByteArrayCrlfSerializer), hence messages 
		will be \r\n delimited data and the gateway can be used by a simple client such as telnet. Each time that I press a key the connection accept by TcpNioServerConnectionFactory (opened 
		by telnet with the command 'connect') reads the key pressed (DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection] - Read 1 into raw buffer DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection] 
		- 0:0:0:0:0:0:0:1:51994:47652404-8ce7-4212-b440-053047159180 Reading...), when I want to finish sending the message I press <Enter> and all the previous characters pressed and sent 
		are processed by the gateway as a complete message and is sent to the request channel. I have notice that always that I send several messages (delimited by <Enter>) the gateway always 
		use the same connection (the connection opened by telnet) and if I want a new connection I need to close the connection from telnet and open a new connection to the server (gateway) 
		and the server will accept it (I think this is because of the server (tcp-inbound-gateway) doesn't write anything as response to the connection so that the connection is closed and for that reason the connection stays alive). 
		When you specify a reply-channel the inbound gateway, after constructing a message with the incoming payload and sending it to the requestChannel, waits 
		for a response and sends the payload from the response message by writing it to the connection, but in this case the inbound-gateway is not receiving a reply message and hence is not 
		going to send a response to the client (telnet)(DEBUG [org.springframework.integration.ip.tcp.TcpInboundGateway] - null reply received for [Payload=[B@26361f38][Headers={timestamp=1383716633242, 
		id=1bfc95c0-a210-4b70-a27a-0239f199b414, ip_tcp_remotePort=52190, ip_address=0:0:0:0:0:0:0:1, ip_hostname=0:0:0:0:0:0:0:1, ip_connectionId=0:0:0:0:0:0:0:1:52190:be7ae41c-25f2-42b8-ba85-a4195570a157}] 
		nothing to send)).************************************************************************************************************************************************************************************** 
		Regarding threads there's a single thread: ************************************************************************************************************************************************************** 
		1) int-ip:tcp-inbound-gateway -> tcpRequestChannel -> int:outbound-channel-adapter ************************************************************************************************************************ 
		The TcpInboundGateway sends and receives the message in sequence (sends the message to the request channel and waits (reply-timeout) for a response from reply-channel) -->

	<int-ip:tcp-connection-factory id="cfServer" type="server" port="1234" using-nio="true" single-use="true" />

	<int:channel id="tcpRequestChannel" />

	<int:channel id="tcpReplyChannel" />

	<int-ip:tcp-inbound-gateway request-channel="tcpRequestChannel" reply-channel="tcpReplyChannel" connection-factory="cfServer" reply-timeout="10000"
		auto-startup="false" />

	<int:outbound-channel-adapter id="tcpOutboundChannelAdapter" channel="tcpRequestChannel" ref="channelAdapterReceiver" method="receiveMessage"
		auto-startup="false" />

	<!-- In this case I am testing a <int-ip:tcp-inbound-gateway, this case is the same as the previous one, except that in this case we have tested the inbound-gateway's reply channel. 
		The inbound gateway, after constructing a message with the incoming payload and sending it to the requestChannel, waits for a response and sends the payload from the response message 
		by writing it to the connection, in this case I have received and seen that response in my telnet client. In this case the same message has been sent to the reply channel and for that 
		reason the ip_connectionId header has been kept and it has been possible to correlate the message to the connection (Note: For the inbound gateway, care must be taken to retain, or 
		populate, the ip_connnection_id header because it is used to correlate the message to a connection. Messages that originate at the gateway will automatically have the header set. If 
		the reply is constructed as a new message, you will need to set the header. The header value can be captured from the incoming message.). A fragment of the logs: *****************************************
		
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioServerConnectionFactory]  - New accept
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - New connection 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.serializer.ByteArrayCrLfSerializer]  - Available to read:0
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 1 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 2 into raw buffer
			 INFO  [org.springframework.integration.endpoint.EventDrivenConsumer]  - Adding {bridge:null} as a subscriber to the 'inboundGatewayWithReplyReplyChannel' channel
			 INFO  [org.springframework.integration.channel.DirectChannel]  - Channel 'inboundGatewayWithReplyReplyChannel' has 1 subscriber(s).
			 INFO  [org.springframework.integration.endpoint.EventDrivenConsumer]  - started org.springframework.integration.endpoint.EventDrivenConsumer@235d4338
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - preSend on channel 'inboundGatewayWithReplyRequestChannel', message: [Payload=[B@1c7c417e][Headers={timestamp=1384585332241, id=56e51f3c-25d5-451f-9bf8-9914cd690871, history=inboundGatewayWithReplyRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@21afc5ce, ip_tcp_remotePort=53862, ip_address=0:0:0:0:0:0:0:1, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@21afc5ce, ip_hostname=0:0:0:0:0:0:0:1, ip_connectionId=0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194}]
			 DEBUG [org.springframework.integration.handler.ServiceActivatingHandler]  - ServiceActivator for [org.springframework.integration.handler.MethodInvokingMessageProcessor@669b3ec2] received message: [Payload=[B@1c7c417e][Headers={timestamp=1384585332241, id=56e51f3c-25d5-451f-9bf8-9914cd690871, history=inboundGatewayWithReplyRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@21afc5ce, ip_tcp_remotePort=53862, ip_address=0:0:0:0:0:0:0:1, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@21afc5ce, ip_hostname=0:0:0:0:0:0:0:1, ip_connectionId=0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194}]
			 INFO  [spring.integration.test.handler.ServiceActivatorCustomizable]  - *************** Received Message for service activator. Mensaje: dante ricalde delado and jelly ribera cordero
			 DEBUG [org.springframework.integration.handler.ServiceActivatingHandler]  - handler 'ServiceActivator for [org.springframework.integration.handler.MethodInvokingMessageProcessor@669b3ec2]' sending reply Message: [Payload=[B@1c7c417e][Headers={timestamp=1384585332244, id=cd4432f0-cf6f-4666-a60b-81415b66bcb6, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@21afc5ce, history=inboundGatewayWithReplyRequestChannel,inboundGatewayWithReplyServiceActivator, ip_address=0:0:0:0:0:0:0:1, ip_tcp_remotePort=53862, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@21afc5ce, ip_hostname=0:0:0:0:0:0:0:1, ip_connectionId=0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194}]
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - preSend on channel 'inboundGatewayWithReplyReplyChannel', message: [Payload=[B@1c7c417e][Headers={timestamp=1384585332263, id=23dadae4-3bee-41ec-a228-97e15f201bc4, history=inboundGatewayWithReplyRequestChannel,inboundGatewayWithReplyServiceActivator,inboundGatewayWithReplyReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@21afc5ce, ip_tcp_remotePort=53862, ip_address=0:0:0:0:0:0:0:1, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@21afc5ce, ip_hostname=0:0:0:0:0:0:0:1, ip_connectionId=0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194}]
			 DEBUG [org.springframework.integration.handler.BridgeHandler]  - org.springframework.integration.handler.BridgeHandler@9720f12 received message: [Payload=[B@1c7c417e][Headers={timestamp=1384585332263, id=23dadae4-3bee-41ec-a228-97e15f201bc4, history=inboundGatewayWithReplyRequestChannel,inboundGatewayWithReplyServiceActivator,inboundGatewayWithReplyReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@21afc5ce, ip_tcp_remotePort=53862, ip_address=0:0:0:0:0:0:0:1, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@21afc5ce, ip_hostname=0:0:0:0:0:0:0:1, ip_connectionId=0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194}]
			 DEBUG [org.springframework.integration.handler.BridgeHandler]  - handler 'org.springframework.integration.handler.BridgeHandler@9720f12' sending reply Message: [Payload=[B@1c7c417e][Headers={timestamp=1384585332263, id=23dadae4-3bee-41ec-a228-97e15f201bc4, history=inboundGatewayWithReplyRequestChannel,inboundGatewayWithReplyServiceActivator,inboundGatewayWithReplyReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@21afc5ce, ip_tcp_remotePort=53862, ip_address=0:0:0:0:0:0:0:1, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@21afc5ce, ip_hostname=0:0:0:0:0:0:0:1, ip_connectionId=0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194}]
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - postSend (sent=true) on channel 'inboundGatewayWithReplyReplyChannel', message: [Payload=[B@1c7c417e][Headers={timestamp=1384585332263, id=23dadae4-3bee-41ec-a228-97e15f201bc4, history=inboundGatewayWithReplyRequestChannel,inboundGatewayWithReplyServiceActivator,inboundGatewayWithReplyReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@21afc5ce, ip_tcp_remotePort=53862, ip_address=0:0:0:0:0:0:0:1, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@21afc5ce, ip_hostname=0:0:0:0:0:0:0:1, ip_connectionId=0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194}]
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - postSend (sent=true) on channel 'inboundGatewayWithReplyRequestChannel', message: [Payload=[B@1c7c417e][Headers={timestamp=1384585332241, id=56e51f3c-25d5-451f-9bf8-9914cd690871, history=inboundGatewayWithReplyRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@21afc5ce, ip_tcp_remotePort=53862, ip_address=0:0:0:0:0:0:0:1, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@21afc5ce, ip_hostname=0:0:0:0:0:0:0:1, ip_connectionId=0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194}]
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 writing 45
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194 writing 2
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Message sent [Payload=[B@1c7c417e][Headers={timestamp=1384585332265, id=f12af3d9-fca6-4c35-b9d5-6e94a53c1cb6, history=inboundGatewayWithReplyRequestChannel,inboundGatewayWithReplyServiceActivator,inboundGatewayWithReplyReplyChannel, ip_address=0:0:0:0:0:0:0:1, ip_tcp_remotePort=53862, ip_hostname=0:0:0:0:0:0:0:1, ip_connectionId=0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194}]
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Closing single-use connection0:0:0:0:0:0:0:1:53862:fc61d021-13aa-448e-8ed0-0abdf8bac194
		 
		Regarding threads there's a single thread: ************************************************************************************************************************************************************** 
		1) int-ip:tcp-inbound-gateway -> inboundGatewayWithReplyRequestChannel -> <int:service-activator -> inboundGatewayWithReplyReplyChannel ************************************************************************************************************************ 
		The TcpInboundGateway sends and receives the message in sequence (sends the message to the request channel and waits (reply-timeout) for a response from reply-channel and then sends that reply by writing it to the connection). 
		Another important aspect that I have noticed is that each time the <int-ip:tcp-inbound-gateway receives the message and sends the response the connection is closed 
		(the connection opened by telnet client) and you see in the telnet client bessides the response the following message: "Connection to host lost. Press any key to continue..."
		and when you press the key you return to the telnet prompt to open a new connection. I think that the connection is closed because it's specified the "single-use" property to
		'true' and If true, a new connection will be created for each use.
		
		 -->
	<int-ip:tcp-connection-factory id="inboundGatewayWithReplyServerConnectionFactory" type="server" port="1234" using-nio="true" single-use="true" />

	<int:channel id="inboundGatewayWithReplyRequestChannel" />

	<int:channel id="inboundGatewayWithReplyReplyChannel" />

	<int-ip:tcp-inbound-gateway request-channel="inboundGatewayWithReplyRequestChannel" reply-channel="inboundGatewayWithReplyReplyChannel"
		connection-factory="inboundGatewayWithReplyServerConnectionFactory" reply-timeout="10000" auto-startup="false" />

	<int:service-activator id="inboundGatewayWithReplyServiceActivator" input-channel="inboundGatewayWithReplyRequestChannel" output-channel="inboundGatewayWithReplyReplyChannel"
		ref="serviceActivatorCustomizable" auto-startup="false" />

	<!-- In this case we are going to test a special case of inbound gateways. As with inbound adapters, inbound gateways normally use a type="server" connection factory, 
		which listens for incoming connection requests. In some cases, it is desireable to establish the connection in reverse, whereby the inbound gateway connects to an 
		external server and then waits for, and replies to, inbound messages on that connection. This topology is supported by using client-mode="true" on the inbound gateway. 
		In this case, the connection factory must be of type 'client' and must have single-use set to false. Two additional attributes are used to support this mechanism: 
		retry-interval specifies (in milliseconds) how often the framework will attempt to reconnect after a connection failure. scheduler is used to supply a 
		TaskScheduler used to schedule the connection attempts, and to test that the connection is still active. The process in this case is very simple: the inbound gateway
		connects to an external server and then waits for a inbound response on that connection (220 Service ready for new user (the first time) and 530 Access denied. 
		(the rest of the times)) and replies to the server with the same message in this case, again the server responds with "530 Access denied." and the gateways responds
		with the same message to the server and so on (for that reason you can notice in the logs that in all the conversations between the gateway and the server is used 
		the same connection (because of single-use="false" in int-ip:tcp-connection-factory and besides the server answer in the same connection (the server doesn't close the connection))).
		Regarding threads, we have:
			At first, when the connection is stablished:(the connection is stablished)
		1.) int-ip:tcp-inbound-gateway -> server 
			For the rest of the process: (the server response to that connection and the gateway process the respone of the server)
		2.) int-ip:tcp-inbound-gateway -> reverseTcpInboundGatewayRequestChannel -> int:service-activator -> reverseTcpInboundGatewayReplyChannel -> server
		
		The thread number 2 is executed the rest of the process.
		
		The logs:
		
		INFO  [org.springframework.integration.ip.tcp.connection.TcpNioClientConnectionFactory]  - started reverseTcpInboundGatewayConnectionFactory
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioClientConnectionFactory]  - Read selector running for connections to 173.245.120.49:21
		DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioClientConnectionFactory]  - Opening new socket channel connection to 173.245.120.49:21
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - New connection agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa
		DEBUG [org.springframework.integration.ip.tcp.connection.ClientModeConnectionManager]  - Connection agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa established
		DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa Reading...
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 33 into raw buffer
		DEBUG [org.springframework.integration.ip.tcp.serializer.ByteArrayCrLfSerializer]  - Available to read:33
		 INFO  [org.springframework.integration.endpoint.EventDrivenConsumer]  - Adding {bridge:null} as a subscriber to the 'reverseTcpInboundGatewayReplyChannel' channel
		 INFO  [org.springframework.integration.channel.DirectChannel]  - Channel 'reverseTcpInboundGatewayReplyChannel' has 1 subscriber(s).
		 INFO  [org.springframework.integration.endpoint.EventDrivenConsumer]  - started org.springframework.integration.endpoint.EventDrivenConsumer@6fec88c4
		 DEBUG [org.springframework.integration.channel.DirectChannel]  - preSend on channel 'reverseTcpInboundGatewayRequestChannel', message: [Payload=[B@4b7bf8a5][Headers={timestamp=1384324461723, id=5277c0d9-0220-4d73-abec-e47042dcfce8, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@38013f5a, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@38013f5a, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.handler.ServiceActivatingHandler]  - ServiceActivator for [org.springframework.integration.handler.MethodInvokingMessageProcessor@3467837] received message: [Payload=[B@4b7bf8a5][Headers={timestamp=1384324461723, id=5277c0d9-0220-4d73-abec-e47042dcfce8, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@38013f5a, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@38013f5a, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 INFO  [spring.integration.test.handler.ServiceActivatorCustomizable]  - *************** Received Message for service activator. Mensaje: 220 Service ready for new user.
		 DEBUG [org.springframework.integration.handler.ServiceActivatingHandler]  - handler 'ServiceActivator for [org.springframework.integration.handler.MethodInvokingMessageProcessor@3467837]' sending reply Message: [Payload=[B@4b7bf8a5][Headers={timestamp=1384324461724, id=fcbc623f-bac4-4f65-9548-3765fd35c41a, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@38013f5a, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator, ip_tcp_remotePort=21, ip_address=173.245.120.49, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@38013f5a, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.channel.DirectChannel]  - preSend on channel 'reverseTcpInboundGatewayReplyChannel', message: [Payload=[B@4b7bf8a5][Headers={timestamp=1384324461737, id=480575de-b0be-4546-91fc-317dbdd0af31, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator,reverseTcpInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@38013f5a, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@38013f5a, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.handler.BridgeHandler]  - org.springframework.integration.handler.BridgeHandler@55fd2f18 received message: [Payload=[B@4b7bf8a5][Headers={timestamp=1384324461737, id=480575de-b0be-4546-91fc-317dbdd0af31, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator,reverseTcpInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@38013f5a, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@38013f5a, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.handler.BridgeHandler]  - handler 'org.springframework.integration.handler.BridgeHandler@55fd2f18' sending reply Message: [Payload=[B@4b7bf8a5][Headers={timestamp=1384324461737, id=480575de-b0be-4546-91fc-317dbdd0af31, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator,reverseTcpInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@38013f5a, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@38013f5a, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.channel.DirectChannel]  - postSend (sent=true) on channel 'reverseTcpInboundGatewayReplyChannel', message: [Payload=[B@4b7bf8a5][Headers={timestamp=1384324461737, id=480575de-b0be-4546-91fc-317dbdd0af31, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator,reverseTcpInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@38013f5a, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@38013f5a, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.channel.DirectChannel]  - postSend (sent=true) on channel 'reverseTcpInboundGatewayRequestChannel', message: [Payload=[B@4b7bf8a5][Headers={timestamp=1384324461723, id=5277c0d9-0220-4d73-abec-e47042dcfce8, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@38013f5a, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@38013f5a, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa writing 31
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa writing 2
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Message sent [Payload=[B@4b7bf8a5][Headers={timestamp=1384324461739, id=4c30eeb2-6bb4-498c-b310-0b0a83fb9f33, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator,reverseTcpInboundGatewayReplyChannel, ip_tcp_remotePort=21, ip_address=173.245.120.49, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa Reading...
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 20 into raw buffer
		 DEBUG [org.springframework.integration.ip.tcp.serializer.ByteArrayCrLfSerializer]  - Available to read:0
		 DEBUG [org.springframework.integration.channel.DirectChannel]  - preSend on channel 'reverseTcpInboundGatewayRequestChannel', message: [Payload=[B@1064450e][Headers={timestamp=1384324461839, id=b3933040-f83e-4b89-b6d7-815cb564bb8d, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@26f1a28a, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@26f1a28a, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.handler.ServiceActivatingHandler]  - ServiceActivator for [org.springframework.integration.handler.MethodInvokingMessageProcessor@3467837] received message: [Payload=[B@1064450e][Headers={timestamp=1384324461839, id=b3933040-f83e-4b89-b6d7-815cb564bb8d, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@26f1a28a, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@26f1a28a, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 INFO  [spring.integration.test.handler.ServiceActivatorCustomizable]  - *************** Received Message for service activator. Mensaje: 530 Access denied.
		 DEBUG [org.springframework.integration.handler.ServiceActivatingHandler]  - handler 'ServiceActivator for [org.springframework.integration.handler.MethodInvokingMessageProcessor@3467837]' sending reply Message: [Payload=[B@1064450e][Headers={timestamp=1384324461840, id=6ab61d7e-e44e-4d2e-a37c-b2610a419540, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@26f1a28a, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator, ip_tcp_remotePort=21, ip_address=173.245.120.49, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@26f1a28a, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.channel.DirectChannel]  - preSend on channel 'reverseTcpInboundGatewayReplyChannel', message: [Payload=[B@1064450e][Headers={timestamp=1384324461841, id=239f5403-7ad3-49be-a816-57ed857e1909, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator,reverseTcpInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@26f1a28a, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@26f1a28a, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.handler.BridgeHandler]  - org.springframework.integration.handler.BridgeHandler@55fd2f18 received message: [Payload=[B@1064450e][Headers={timestamp=1384324461841, id=239f5403-7ad3-49be-a816-57ed857e1909, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator,reverseTcpInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@26f1a28a, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@26f1a28a, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.handler.BridgeHandler]  - handler 'org.springframework.integration.handler.BridgeHandler@55fd2f18' sending reply Message: [Payload=[B@1064450e][Headers={timestamp=1384324461841, id=239f5403-7ad3-49be-a816-57ed857e1909, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator,reverseTcpInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@26f1a28a, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@26f1a28a, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.channel.DirectChannel]  - postSend (sent=true) on channel 'reverseTcpInboundGatewayReplyChannel', message: [Payload=[B@1064450e][Headers={timestamp=1384324461841, id=239f5403-7ad3-49be-a816-57ed857e1909, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator,reverseTcpInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@26f1a28a, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@26f1a28a, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.channel.DirectChannel]  - postSend (sent=true) on channel 'reverseTcpInboundGatewayRequestChannel', message: [Payload=[B@1064450e][Headers={timestamp=1384324461839, id=b3933040-f83e-4b89-b6d7-815cb564bb8d, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@26f1a28a, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@26f1a28a, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa writing 18
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa writing 2
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Message sent [Payload=[B@1064450e][Headers={timestamp=1384324461843, id=c131cda9-edfc-40d6-a4df-9d8aef109667, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator,reverseTcpInboundGatewayReplyChannel, ip_tcp_remotePort=21, ip_address=173.245.120.49, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.ip.tcp.serializer.ByteArrayCrLfSerializer]  - Available to read:0
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa Reading...
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 20 into raw buffer
		 DEBUG [org.springframework.integration.channel.DirectChannel]  - preSend on channel 'reverseTcpInboundGatewayRequestChannel', message: [Payload=[B@7365b411][Headers={timestamp=1384324461980, id=e784cffd-451e-4fae-9cf8-51e1f1dc1650, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a110347, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a110347, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.handler.ServiceActivatingHandler]  - ServiceActivator for [org.springframework.integration.handler.MethodInvokingMessageProcessor@3467837] received message: [Payload=[B@7365b411][Headers={timestamp=1384324461980, id=e784cffd-451e-4fae-9cf8-51e1f1dc1650, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a110347, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a110347, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 INFO  [spring.integration.test.handler.ServiceActivatorCustomizable]  - *************** Received Message for service activator. Mensaje: 530 Access denied.
		 DEBUG [org.springframework.integration.handler.ServiceActivatingHandler]  - handler 'ServiceActivator for [org.springframework.integration.handler.MethodInvokingMessageProcessor@3467837]' sending reply Message: [Payload=[B@7365b411][Headers={timestamp=1384324461980, id=cd7c436f-e596-4af7-9bb8-698710cd361a, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a110347, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator, ip_tcp_remotePort=21, ip_address=173.245.120.49, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a110347, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.channel.DirectChannel]  - preSend on channel 'reverseTcpInboundGatewayReplyChannel', message: [Payload=[B@7365b411][Headers={timestamp=1384324461981, id=070387d3-8b5b-4c77-b9da-e826f63ae4d8, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator,reverseTcpInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a110347, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a110347, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.handler.BridgeHandler]  - org.springframework.integration.handler.BridgeHandler@55fd2f18 received message: [Payload=[B@7365b411][Headers={timestamp=1384324461981, id=070387d3-8b5b-4c77-b9da-e826f63ae4d8, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator,reverseTcpInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a110347, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a110347, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.handler.BridgeHandler]  - handler 'org.springframework.integration.handler.BridgeHandler@55fd2f18' sending reply Message: [Payload=[B@7365b411][Headers={timestamp=1384324461981, id=070387d3-8b5b-4c77-b9da-e826f63ae4d8, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator,reverseTcpInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a110347, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a110347, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.channel.DirectChannel]  - postSend (sent=true) on channel 'reverseTcpInboundGatewayReplyChannel', message: [Payload=[B@7365b411][Headers={timestamp=1384324461981, id=070387d3-8b5b-4c77-b9da-e826f63ae4d8, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator,reverseTcpInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a110347, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a110347, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.channel.DirectChannel]  - postSend (sent=true) on channel 'reverseTcpInboundGatewayRequestChannel', message: [Payload=[B@7365b411][Headers={timestamp=1384324461980, id=e784cffd-451e-4fae-9cf8-51e1f1dc1650, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a110347, ip_address=173.245.120.49, ip_tcp_remotePort=21, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a110347, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa writing 18
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa writing 2
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Message sent [Payload=[B@7365b411][Headers={timestamp=1384324461983, id=9b732a95-df4c-45c9-b9d7-21099f026096, history=reverseTcpInboundGateway,reverseTcpInboundGatewayRequestChannel,reverseTcpInboundGatewayServiceActivator,reverseTcpInboundGatewayReplyChannel, ip_tcp_remotePort=21, ip_address=173.245.120.49, ip_hostname=agn-am2-ftp01.carpathiahost.net, ip_connectionId=agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa}]
		 DEBUG [org.springframework.integration.ip.tcp.serializer.ByteArrayCrLfSerializer]  - Available to read:0
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - agn-am2-ftp01.carpathiahost.net:21:b645a01b-d9da-4ea1-ad1b-394fa6b6dbfa Reading...
		 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 20 into raw buffer	
		 -->
		
	<int:channel id="reverseTcpInboundGatewayRequestChannel" />
	
	<int:channel id="reverseTcpInboundGatewayReplyChannel" />
	
<!-- 	<bean id="reverseTcpInboundGatewayCachingConnectionFactory" class="org.springframework.integration.ip.tcp.connection.CachingClientConnectionFactory"> -->
<!-- 		<constructor-arg ref="reverseTcpInboundGatewayConnectionFactory" /> -->
<!-- 		<constructor-arg value="2" /> -->
<!-- 		<property name="singleUse" value="false"></property> -->
<!-- 	</bean> -->
	
	<int-ip:tcp-connection-factory id="reverseTcpInboundGatewayConnectionFactory" type="client" single-use="false" host="173.245.120.49" port="21" using-nio="true" />
	
	<int-ip:tcp-inbound-gateway id="reverseTcpInboundGateway" request-channel="reverseTcpInboundGatewayRequestChannel" reply-channel="reverseTcpInboundGatewayReplyChannel"
		connection-factory="reverseTcpInboundGatewayConnectionFactory" client-mode="true" retry-interval="10000" auto-startup="false" />
	
	<int:service-activator id="reverseTcpInboundGatewayServiceActivator" input-channel="reverseTcpInboundGatewayRequestChannel" output-channel="reverseTcpInboundGatewayReplyChannel"
		ref="serviceActivatorCustomizable" auto-startup="false" />

	<!-- In this case I am testing a <int-ip:tcp-outbound-gateway working in combination with a <int-ip:tcp-inbound-gateway. The process is the following:
		The <int-ip:tcp-outbound-gateway opens a new socket when receives a message from the <int:inbound-channel-adapter to send a message and the 
		TcpNioServerConnectionFactory (<int-ip:tcp-inbound-gateway) accepts (and the <int-ip:tcp-inbound-gateway gets a client connection to send to and receive messages
		from server) and opens its own new connection in a random port (Theory about Dynamic, private or ephemeral ports says: The range 4915265535 
		(215+214 to 2161)  above the registered ports  contains dynamic or private ports that cannot be registered with IANA.[138] This range is used for custom or 
		temporary purposes and for automatic allocation of ephemeral ports.) to read the messages recived and write the response that it has been generated by the server.
		Then the client connection reads the message received from server and is processed by the <int-ip:tcp-outbound-gateway.
		Regarding threads we have:
		
		1.) <int:inbound-channel-adapter -> combinedGatewayRequestChannel -> <int-ip:tcp-outbound-gateway -> host -> combinedGatewayReplyChannel (<int-ip:tcp-outbound-gateway) -> <int:outbound-channel-adapter
		
		2.) (host) <int-ip:tcp-inbound-gateway -> combinedGatewayInboundGatewayRequestChannel -> <int:service-activator -> combinedGatewayInboundGatewayReplyChannel -> client (<int-ip:tcp-inbound-gateway)
		
		You need to take into account that after the <int-ip:tcp-outbound-gateway sends the message to the host over the connection waits for a response (it uses the 
		property "remote-timeout") and constructs a response message and puts in on the reply channel. 
		
		The logs are:
		
			 DEBUG [org.springframework.integration.endpoint.SourcePollingChannelAdapter]  - Poll resulted in Message: [Payload=Dantito Ricalde Rivera][Headers={timestamp=1384587574940, id=64d89827-04a3-4571-a9cd-c8e599dfcace, anotherPaymentType=DEBIT}]
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - preSend on channel 'combinedGatewayRequestChannel', message: [Payload=Dantito Ricalde Rivera][Headers={timestamp=1384587574940, id=30214bbd-92c3-444f-acc7-c53ce91296ec, anotherPaymentType=DEBIT, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel}]
			 DEBUG [org.springframework.integration.ip.tcp.TcpOutboundGateway]  - org.springframework.integration.ip.tcp.TcpOutboundGateway#0 received message: [Payload=Dantito Ricalde Rivera][Headers={timestamp=1384587574940, id=30214bbd-92c3-444f-acc7-c53ce91296ec, anotherPaymentType=DEBIT, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel}]
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioClientConnectionFactory]  - Opening new socket channel connection to localhost:12345
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioServerConnectionFactory]  - New accept
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - New connection localhost:12345:695dee09-8c08-402f-ba71-4ac6eb979a7e
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - New connection 127.0.0.1:54440:f69a6971-6eb2-4659-af3d-e2be35b78fca
			 DEBUG [org.springframework.integration.ip.tcp.TcpOutboundGateway]  - Added localhost:12345:695dee09-8c08-402f-ba71-4ac6eb979a7e
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - localhost:12345:695dee09-8c08-402f-ba71-4ac6eb979a7e writing 22
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - localhost:12345:695dee09-8c08-402f-ba71-4ac6eb979a7e writing 2
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 127.0.0.1:54440:f69a6971-6eb2-4659-af3d-e2be35b78fca Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 22 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.serializer.ByteArrayCrLfSerializer]  - Available to read:0
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 127.0.0.1:54440:f69a6971-6eb2-4659-af3d-e2be35b78fca Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 2 into raw buffer
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - preSend on channel 'combinedGatewayInboundGatewayRequestChannel', message: [Payload=[B@6506b132][Headers={timestamp=1384587574945, id=b4471d40-8380-4265-bb84-59a7c087ff22, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a5b7d6f, ip_address=127.0.0.1, ip_tcp_remotePort=54440, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a5b7d6f, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54440:f69a6971-6eb2-4659-af3d-e2be35b78fca}]
			 DEBUG [org.springframework.integration.handler.ServiceActivatingHandler]  - ServiceActivator for [org.springframework.integration.handler.MethodInvokingMessageProcessor@6d90851d] received message: [Payload=[B@6506b132][Headers={timestamp=1384587574945, id=b4471d40-8380-4265-bb84-59a7c087ff22, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a5b7d6f, ip_address=127.0.0.1, ip_tcp_remotePort=54440, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a5b7d6f, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54440:f69a6971-6eb2-4659-af3d-e2be35b78fca}]
			 INFO  [spring.integration.test.handler.ServiceActivatorCustomizable]  - *************** Received Message for service activator. Mensaje: Dantito Ricalde Rivera
			 DEBUG [org.springframework.integration.handler.ServiceActivatingHandler]  - handler 'ServiceActivator for [org.springframework.integration.handler.MethodInvokingMessageProcessor@6d90851d]' sending reply Message: [Payload=[B@6506b132][Headers={timestamp=1384587574946, id=7791b1e4-7c63-49fb-80a7-60fa42da325f, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a5b7d6f, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel,combinedGatewayInboundGatewayServiceActivator, ip_tcp_remotePort=54440, ip_address=127.0.0.1, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a5b7d6f, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54440:f69a6971-6eb2-4659-af3d-e2be35b78fca}]
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - preSend on channel 'combinedGatewayInboundGatewayReplyChannel', message: [Payload=[B@6506b132][Headers={timestamp=1384587574946, id=7894eede-b559-466e-909e-5e0a39686b92, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel,combinedGatewayInboundGatewayServiceActivator,combinedGatewayInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a5b7d6f, ip_address=127.0.0.1, ip_tcp_remotePort=54440, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a5b7d6f, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54440:f69a6971-6eb2-4659-af3d-e2be35b78fca}]
			 DEBUG [org.springframework.integration.handler.BridgeHandler]  - org.springframework.integration.handler.BridgeHandler@59a80c6a received message: [Payload=[B@6506b132][Headers={timestamp=1384587574946, id=7894eede-b559-466e-909e-5e0a39686b92, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel,combinedGatewayInboundGatewayServiceActivator,combinedGatewayInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a5b7d6f, ip_address=127.0.0.1, ip_tcp_remotePort=54440, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a5b7d6f, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54440:f69a6971-6eb2-4659-af3d-e2be35b78fca}]
			 DEBUG [org.springframework.integration.handler.BridgeHandler]  - handler 'org.springframework.integration.handler.BridgeHandler@59a80c6a' sending reply Message: [Payload=[B@6506b132][Headers={timestamp=1384587574946, id=7894eede-b559-466e-909e-5e0a39686b92, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel,combinedGatewayInboundGatewayServiceActivator,combinedGatewayInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a5b7d6f, ip_address=127.0.0.1, ip_tcp_remotePort=54440, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a5b7d6f, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54440:f69a6971-6eb2-4659-af3d-e2be35b78fca}]
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - postSend (sent=true) on channel 'combinedGatewayInboundGatewayReplyChannel', message: [Payload=[B@6506b132][Headers={timestamp=1384587574946, id=7894eede-b559-466e-909e-5e0a39686b92, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel,combinedGatewayInboundGatewayServiceActivator,combinedGatewayInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a5b7d6f, ip_address=127.0.0.1, ip_tcp_remotePort=54440, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a5b7d6f, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54440:f69a6971-6eb2-4659-af3d-e2be35b78fca}]
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - postSend (sent=true) on channel 'combinedGatewayInboundGatewayRequestChannel', message: [Payload=[B@6506b132][Headers={timestamp=1384587574945, id=b4471d40-8380-4265-bb84-59a7c087ff22, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a5b7d6f, ip_address=127.0.0.1, ip_tcp_remotePort=54440, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@1a5b7d6f, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54440:f69a6971-6eb2-4659-af3d-e2be35b78fca}]
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Message sent [Payload=Dantito Ricalde Rivera][Headers={timestamp=1384587574941, id=a427bca6-bc18-4de0-9cc0-cb0130d03f72, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel,combinedGatewayTcpOutboundGateway, anotherPaymentType=DEBIT}]
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 127.0.0.1:54440:f69a6971-6eb2-4659-af3d-e2be35b78fca writing 22
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 127.0.0.1:54440:f69a6971-6eb2-4659-af3d-e2be35b78fca writing 2
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - localhost:12345:695dee09-8c08-402f-ba71-4ac6eb979a7e Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 24 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.serializer.ByteArrayCrLfSerializer]  - Available to read:0
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Message sent [Payload=[B@6506b132][Headers={timestamp=1384587574947, id=276e05e7-70cc-41a2-b1bd-e0ba16857a3e, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel,combinedGatewayInboundGatewayServiceActivator,combinedGatewayInboundGatewayReplyChannel, ip_tcp_remotePort=54440, ip_address=127.0.0.1, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54440:f69a6971-6eb2-4659-af3d-e2be35b78fca}]
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Closing single-use connection127.0.0.1:54440:f69a6971-6eb2-4659-af3d-e2be35b78fca
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Closing single use cbannel after inbound message localhost:12345:695dee09-8c08-402f-ba71-4ac6eb979a7e
			 DEBUG [org.springframework.integration.ip.tcp.TcpOutboundGateway]  - Respose [Payload=[B@6c880fed][Headers={timestamp=1384587574949, id=2a6b430c-ec59-48df-b58f-d3ab76209394, ip_tcp_remotePort=12345, ip_address=127.0.0.1, ip_hostname=localhost, ip_connectionId=localhost:12345:695dee09-8c08-402f-ba71-4ac6eb979a7e}]
			 DEBUG [org.springframework.integration.ip.tcp.TcpOutboundGateway]  - handler 'org.springframework.integration.ip.tcp.TcpOutboundGateway#0' sending reply Message: [Payload=[B@6c880fed][Headers={timestamp=1384587574949, id=aaf66cba-f4ae-402f-8f7f-4c365d785f6e, anotherPaymentType=DEBIT, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel,combinedGatewayTcpOutboundGateway, ip_address=127.0.0.1, ip_tcp_remotePort=12345, ip_hostname=localhost, ip_connectionId=localhost:12345:695dee09-8c08-402f-ba71-4ac6eb979a7e}]
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - localhost:12345:695dee09-8c08-402f-ba71-4ac6eb979a7e Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioServerConnectionFactory]  - Removing closed channel
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - preSend on channel 'combinedGatewayReplyChannel', message: [Payload=[B@6c880fed][Headers={timestamp=1384587574950, id=5349e242-217d-434d-adc6-f778bd90a677, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel,combinedGatewayTcpOutboundGateway,combinedGatewayReplyChannel, anotherPaymentType=DEBIT, ip_tcp_remotePort=12345, ip_address=127.0.0.1, ip_hostname=localhost, ip_connectionId=localhost:12345:695dee09-8c08-402f-ba71-4ac6eb979a7e}]
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - localhost:12345:695dee09-8c08-402f-ba71-4ac6eb979a7e Channel is closed
			 DEBUG [org.springframework.integration.handler.MethodInvokingMessageHandler]  - org.springframework.integration.handler.MethodInvokingMessageHandler#29 received message: [Payload=[B@6c880fed][Headers={timestamp=1384587574950, id=5349e242-217d-434d-adc6-f778bd90a677, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel,combinedGatewayTcpOutboundGateway,combinedGatewayReplyChannel, anotherPaymentType=DEBIT, ip_tcp_remotePort=12345, ip_address=127.0.0.1, ip_hostname=localhost, ip_connectionId=localhost:12345:695dee09-8c08-402f-ba71-4ac6eb979a7e}]
			 INFO  [spring.integration.test.adapter.receiver.ChannelAdapterReceiver]  - Channel Adapter Receiver: Message Received: [Payload=[B@6c880fed][Headers={timestamp=1384587574951, id=db850700-e375-446a-8a04-352b12d6c077, anotherPaymentType=DEBIT, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel,combinedGatewayTcpOutboundGateway,combinedGatewayReplyChannel,simpleTcpOutboundGatewayOutboundChannelAdapter, ip_address=127.0.0.1, ip_tcp_remotePort=12345, ip_hostname=localhost, ip_connectionId=localhost:12345:695dee09-8c08-402f-ba71-4ac6eb979a7e}]*********END OF THE MESSAGE *************************
			 INFO  [spring.integration.test.adapter.receiver.ChannelAdapterReceiver]  - Channel Adapter Receiver: Payload array of bytes to String: Dantito Ricalde Rivera
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - postSend (sent=true) on channel 'combinedGatewayReplyChannel', message: [Payload=[B@6c880fed][Headers={timestamp=1384587574950, id=5349e242-217d-434d-adc6-f778bd90a677, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel,combinedGatewayTcpOutboundGateway,combinedGatewayReplyChannel, anotherPaymentType=DEBIT, ip_tcp_remotePort=12345, ip_address=127.0.0.1, ip_hostname=localhost, ip_connectionId=localhost:12345:695dee09-8c08-402f-ba71-4ac6eb979a7e}]
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - postSend (sent=true) on channel 'combinedGatewayRequestChannel', message: [Payload=Dantito Ricalde Rivera][Headers={timestamp=1384587574940, id=30214bbd-92c3-444f-acc7-c53ce91296ec, anotherPaymentType=DEBIT, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel}]
			 DEBUG [org.springframework.integration.endpoint.SourcePollingChannelAdapter]  - Poll resulted in Message: [Payload=Danielito Ricalde Rivera][Headers={timestamp=1384587584939, id=dce3b2c8-fdcb-4115-ba6f-6511b73bfa3a, anotherPaymentType=PERSONAL CHECK}]
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - preSend on channel 'combinedGatewayRequestChannel', message: [Payload=Danielito Ricalde Rivera][Headers={timestamp=1384587584939, id=80809742-d474-4043-9f65-744967542c89, anotherPaymentType=PERSONAL CHECK, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel}]
			 DEBUG [org.springframework.integration.ip.tcp.TcpOutboundGateway]  - org.springframework.integration.ip.tcp.TcpOutboundGateway#0 received message: [Payload=Danielito Ricalde Rivera][Headers={timestamp=1384587584939, id=80809742-d474-4043-9f65-744967542c89, anotherPaymentType=PERSONAL CHECK, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel}]
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioClientConnectionFactory]  - Opening new socket channel connection to localhost:12345
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioServerConnectionFactory]  - New accept
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - New connection localhost:12345:a95abbc9-e20d-4a78-ab9c-36fb07d2ed2b
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioClientConnectionFactory]  - Removing closed channel
			 DEBUG [org.springframework.integration.ip.tcp.TcpOutboundGateway]  - Added localhost:12345:a95abbc9-e20d-4a78-ab9c-36fb07d2ed2b
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - localhost:12345:a95abbc9-e20d-4a78-ab9c-36fb07d2ed2b writing 24
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - localhost:12345:a95abbc9-e20d-4a78-ab9c-36fb07d2ed2b writing 2
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Message sent [Payload=Danielito Ricalde Rivera][Headers={timestamp=1384587584940, id=8efc4694-87ce-40aa-bdb5-00bacfde83b8, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel,combinedGatewayTcpOutboundGateway, anotherPaymentType=PERSONAL CHECK}]
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - New connection 127.0.0.1:54443:9bb968b3-efca-4761-b7ae-693f3cd45dc6
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 127.0.0.1:54443:9bb968b3-efca-4761-b7ae-693f3cd45dc6 Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 26 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.serializer.ByteArrayCrLfSerializer]  - Available to read:0
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - preSend on channel 'combinedGatewayInboundGatewayRequestChannel', message: [Payload=[B@b2dd686][Headers={timestamp=1384587584946, id=2479dffb-9d7d-428e-9c93-67e332a4e7b2, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@6e5efd25, ip_address=127.0.0.1, ip_tcp_remotePort=54443, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@6e5efd25, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54443:9bb968b3-efca-4761-b7ae-693f3cd45dc6}]
			 DEBUG [org.springframework.integration.handler.ServiceActivatingHandler]  - ServiceActivator for [org.springframework.integration.handler.MethodInvokingMessageProcessor@6d90851d] received message: [Payload=[B@b2dd686][Headers={timestamp=1384587584946, id=2479dffb-9d7d-428e-9c93-67e332a4e7b2, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@6e5efd25, ip_address=127.0.0.1, ip_tcp_remotePort=54443, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@6e5efd25, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54443:9bb968b3-efca-4761-b7ae-693f3cd45dc6}]
			 INFO  [spring.integration.test.handler.ServiceActivatorCustomizable]  - *************** Received Message for service activator. Mensaje: Danielito Ricalde Rivera
			 DEBUG [org.springframework.integration.handler.ServiceActivatingHandler]  - handler 'ServiceActivator for [org.springframework.integration.handler.MethodInvokingMessageProcessor@6d90851d]' sending reply Message: [Payload=[B@b2dd686][Headers={timestamp=1384587584951, id=d218837b-323e-4837-946b-54eedd5b4131, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@6e5efd25, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel,combinedGatewayInboundGatewayServiceActivator, ip_tcp_remotePort=54443, ip_address=127.0.0.1, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@6e5efd25, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54443:9bb968b3-efca-4761-b7ae-693f3cd45dc6}]
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - preSend on channel 'combinedGatewayInboundGatewayReplyChannel', message: [Payload=[B@b2dd686][Headers={timestamp=1384587584952, id=36cfec75-4db2-466d-a6dc-c4628105eb06, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel,combinedGatewayInboundGatewayServiceActivator,combinedGatewayInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@6e5efd25, ip_address=127.0.0.1, ip_tcp_remotePort=54443, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@6e5efd25, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54443:9bb968b3-efca-4761-b7ae-693f3cd45dc6}]
			 DEBUG [org.springframework.integration.handler.BridgeHandler]  - org.springframework.integration.handler.BridgeHandler@59a80c6a received message: [Payload=[B@b2dd686][Headers={timestamp=1384587584952, id=36cfec75-4db2-466d-a6dc-c4628105eb06, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel,combinedGatewayInboundGatewayServiceActivator,combinedGatewayInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@6e5efd25, ip_address=127.0.0.1, ip_tcp_remotePort=54443, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@6e5efd25, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54443:9bb968b3-efca-4761-b7ae-693f3cd45dc6}]
			 DEBUG [org.springframework.integration.handler.BridgeHandler]  - handler 'org.springframework.integration.handler.BridgeHandler@59a80c6a' sending reply Message: [Payload=[B@b2dd686][Headers={timestamp=1384587584952, id=36cfec75-4db2-466d-a6dc-c4628105eb06, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel,combinedGatewayInboundGatewayServiceActivator,combinedGatewayInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@6e5efd25, ip_address=127.0.0.1, ip_tcp_remotePort=54443, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@6e5efd25, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54443:9bb968b3-efca-4761-b7ae-693f3cd45dc6}]
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - postSend (sent=true) on channel 'combinedGatewayInboundGatewayReplyChannel', message: [Payload=[B@b2dd686][Headers={timestamp=1384587584952, id=36cfec75-4db2-466d-a6dc-c4628105eb06, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel,combinedGatewayInboundGatewayServiceActivator,combinedGatewayInboundGatewayReplyChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@6e5efd25, ip_address=127.0.0.1, ip_tcp_remotePort=54443, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@6e5efd25, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54443:9bb968b3-efca-4761-b7ae-693f3cd45dc6}]
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - postSend (sent=true) on channel 'combinedGatewayInboundGatewayRequestChannel', message: [Payload=[B@b2dd686][Headers={timestamp=1384587584946, id=2479dffb-9d7d-428e-9c93-67e332a4e7b2, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel, errorChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@6e5efd25, ip_address=127.0.0.1, ip_tcp_remotePort=54443, replyChannel=org.springframework.integration.core.MessagingTemplate$TemporaryReplyChannel@6e5efd25, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54443:9bb968b3-efca-4761-b7ae-693f3cd45dc6}]
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 127.0.0.1:54443:9bb968b3-efca-4761-b7ae-693f3cd45dc6 writing 24
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - 127.0.0.1:54443:9bb968b3-efca-4761-b7ae-693f3cd45dc6 writing 2
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Message sent [Payload=[B@b2dd686][Headers={timestamp=1384587584952, id=9b446d6c-6ff0-4182-bbd3-22ae026d5aca, history=combinedGatewayInboundGatewayTcpInboundGateway,combinedGatewayInboundGatewayRequestChannel,combinedGatewayInboundGatewayServiceActivator,combinedGatewayInboundGatewayReplyChannel, ip_tcp_remotePort=54443, ip_address=127.0.0.1, ip_hostname=127.0.0.1, ip_connectionId=127.0.0.1:54443:9bb968b3-efca-4761-b7ae-693f3cd45dc6}]
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Closing single-use connection127.0.0.1:54443:9bb968b3-efca-4761-b7ae-693f3cd45dc6
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - localhost:12345:a95abbc9-e20d-4a78-ab9c-36fb07d2ed2b Reading...
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Read 26 into raw buffer
			 DEBUG [org.springframework.integration.ip.tcp.serializer.ByteArrayCrLfSerializer]  - Available to read:0
			 DEBUG [org.springframework.integration.ip.tcp.connection.TcpNioConnection]  - Closing single use cbannel after inbound message localhost:12345:a95abbc9-e20d-4a78-ab9c-36fb07d2ed2b
			 DEBUG [org.springframework.integration.ip.tcp.TcpOutboundGateway]  - Respose [Payload=[B@1e3dc0bf][Headers={timestamp=1384587584955, id=44a93ba7-87f7-45ee-bb3c-d690f95d9635, ip_tcp_remotePort=12345, ip_address=127.0.0.1, ip_hostname=localhost, ip_connectionId=localhost:12345:a95abbc9-e20d-4a78-ab9c-36fb07d2ed2b}]
			 DEBUG [org.springframework.integration.ip.tcp.TcpOutboundGateway]  - handler 'org.springframework.integration.ip.tcp.TcpOutboundGateway#0' sending reply Message: [Payload=[B@1e3dc0bf][Headers={timestamp=1384587584956, id=c438b85d-784c-4fa9-a055-bbc7c892b2b9, anotherPaymentType=PERSONAL CHECK, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel,combinedGatewayTcpOutboundGateway, ip_address=127.0.0.1, ip_tcp_remotePort=12345, ip_hostname=localhost, ip_connectionId=localhost:12345:a95abbc9-e20d-4a78-ab9c-36fb07d2ed2b}]
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - preSend on channel 'combinedGatewayReplyChannel', message: [Payload=[B@1e3dc0bf][Headers={timestamp=1384587584956, id=bca5e7fd-d3cd-45ba-8198-dbb07fc644f1, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel,combinedGatewayTcpOutboundGateway,combinedGatewayReplyChannel, anotherPaymentType=PERSONAL CHECK, ip_tcp_remotePort=12345, ip_address=127.0.0.1, ip_hostname=localhost, ip_connectionId=localhost:12345:a95abbc9-e20d-4a78-ab9c-36fb07d2ed2b}]
			 DEBUG [org.springframework.integration.handler.MethodInvokingMessageHandler]  - org.springframework.integration.handler.MethodInvokingMessageHandler#29 received message: [Payload=[B@1e3dc0bf][Headers={timestamp=1384587584956, id=bca5e7fd-d3cd-45ba-8198-dbb07fc644f1, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel,combinedGatewayTcpOutboundGateway,combinedGatewayReplyChannel, anotherPaymentType=PERSONAL CHECK, ip_tcp_remotePort=12345, ip_address=127.0.0.1, ip_hostname=localhost, ip_connectionId=localhost:12345:a95abbc9-e20d-4a78-ab9c-36fb07d2ed2b}]
			 INFO  [spring.integration.test.adapter.receiver.ChannelAdapterReceiver]  - Channel Adapter Receiver: Message Received: [Payload=[B@1e3dc0bf][Headers={timestamp=1384587584956, id=333fafa1-78ee-46bd-9462-d0ff433575aa, anotherPaymentType=PERSONAL CHECK, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel,combinedGatewayTcpOutboundGateway,combinedGatewayReplyChannel,simpleTcpOutboundGatewayOutboundChannelAdapter, ip_address=127.0.0.1, ip_tcp_remotePort=12345, ip_hostname=localhost, ip_connectionId=localhost:12345:a95abbc9-e20d-4a78-ab9c-36fb07d2ed2b}]*********END OF THE MESSAGE *************************
			 INFO  [spring.integration.test.adapter.receiver.ChannelAdapterReceiver]  - Channel Adapter Receiver: Payload array of bytes to String: Danielito Ricalde Rivera
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - postSend (sent=true) on channel 'combinedGatewayReplyChannel', message: [Payload=[B@1e3dc0bf][Headers={timestamp=1384587584956, id=bca5e7fd-d3cd-45ba-8198-dbb07fc644f1, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel,combinedGatewayTcpOutboundGateway,combinedGatewayReplyChannel, anotherPaymentType=PERSONAL CHECK, ip_tcp_remotePort=12345, ip_address=127.0.0.1, ip_hostname=localhost, ip_connectionId=localhost:12345:a95abbc9-e20d-4a78-ab9c-36fb07d2ed2b}]
			 DEBUG [org.springframework.integration.channel.DirectChannel]  - postSend (sent=true) on channel 'combinedGatewayRequestChannel', message: [Payload=Danielito Ricalde Rivera][Headers={timestamp=1384587584939, id=80809742-d474-4043-9f65-744967542c89, anotherPaymentType=PERSONAL CHECK, history=combinedGatewayInboundChannelAdapter,combinedGatewayRequestChannel}]
		 -->
	
	<int:channel id="combinedGatewayInboundGatewayRequestChannel" />
	
	<int:channel id="combinedGatewayInboundGatewayReplyChannel" />
	
	<int-ip:tcp-connection-factory id="combinedGatewayInboundGatewayServerConnectionFactory" type="server" host="localhost" port="12345" using-nio="true" 
		single-use="true" />
		
	<int-ip:tcp-inbound-gateway id="combinedGatewayInboundGatewayTcpInboundGateway" request-channel="combinedGatewayInboundGatewayRequestChannel"
		reply-channel="combinedGatewayInboundGatewayReplyChannel" connection-factory="combinedGatewayInboundGatewayServerConnectionFactory" auto-startup="false" />
		
	<int:service-activator id="combinedGatewayInboundGatewayServiceActivator" input-channel="combinedGatewayInboundGatewayRequestChannel"
		output-channel="combinedGatewayInboundGatewayReplyChannel" ref="serviceActivatorCustomizable" auto-startup="false" />
	
	
	
	
	<int:inbound-channel-adapter id="combinedGatewayInboundChannelAdapter"
		expression="T(java.lang.Math).random() > 0.5 ? T(org.springframework.integration.support.MessageBuilder).withPayload('Dantito Ricalde Rivera').setHeader('anotherPaymentType', 'DEBIT').build(): 
    		T(org.springframework.integration.support.MessageBuilder).withPayload('Danielito Ricalde Rivera').setHeader('anotherPaymentType', 'PERSONAL CHECK').build()"
		channel="combinedGatewayRequestChannel" auto-startup="false">
		<int:poller fixed-rate="10000" />
	</int:inbound-channel-adapter>
		
	<int:channel id="combinedGatewayRequestChannel" />
	
	<int:channel id="combinedGatewayReplyChannel" />
	
	<int-ip:tcp-connection-factory id="combinedGatewayClientConnectionFactory" type="client" single-use="true" host="localhost" port="12345" using-nio="true" />
		
	<int-ip:tcp-outbound-gateway id="combinedGatewayTcpOutboundGateway" request-channel="combinedGatewayRequestChannel" reply-channel="combinedGatewayReplyChannel"
		connection-factory="combinedGatewayClientConnectionFactory" request-timeout="10000" remote-timeout="10000" auto-startup="false" />
		
	<int:outbound-channel-adapter id="simpleTcpOutboundGatewayOutboundChannelAdapter" channel="combinedGatewayReplyChannel" ref="channelAdapterReceiver" method="receiveMessage"
		 auto-startup="false" />
	
</beans>